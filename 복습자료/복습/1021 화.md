# 1021 화

</BR>
</BR>
</BR>



>## join : 2개 이상 테이블의 칼럼을 합쳐 "가상의 결과 테이블"을 만드는 연산.

&nbsp;	소스 테이블, 타겟 테이블 개념과 함께 **조인 연산(동등조인/비동등조인)에 의해 결과가 달라짐**

&nbsp;	- 소스 테이블 : 먼저 읽는 테이블

&nbsp;	- 타켓 테이블 : 소스 테이블에 조인할 대상이 되는 테이블

</BR>
</BR>
</BR>



>## 조인의 종류

&nbsp;	- inner join : 가장 많이 쓰이는 조인, **양쪽 테이블 조인 조건을 만족하는 행만 출력**

&nbsp;	- self join : 같은 테이블을 두 번 참조 (**상사-직원처럼 계층관계**를 표현)

&nbsp;	- outer join : 한쪽 테이블의 행은 모두 유지, 다른 쪽 조건 만족행을 붙임

&nbsp;	- 비동등 조인 : 범위로 조인 (between 등) 예) 급여를 등급 범위 테이블과 매칭

</BR>
</BR>
</BR>

>## 기본 개념

&nbsp;	- SELECT : 무엇을 보여줄지 선택 (결과로 보고 싶은 컬럼(또는 계산값)

&nbsp;	- FROM : 어떤 테이블에서 가져올지 지정 (기준 테이블 또는 JOIN해서 사용할 테이블 지정)

&nbsp;	- GROUP BY : 행들을 어떤 기준으로 묶어서 집계할지 지정 >> 예)부서별, 직급별, 날짜별 등

&nbsp;	- WHERE : 행을 먼저 필터링 (조건을 만족하는 행만 남김, 집계되기 전 단계 필터)

&nbsp;	- HAVING : 그룹핑(집계) 이후 결과를 다시 필터링 >> 예) 평균급여 > 5000 인 부서만 남기기

&nbsp;	- ORDER BY : 결과를 정렬 ( ORDER BY (컬럼) \[ASC/DESC])

&nbsp;	

&nbsp;	- 실행 흐름 순서 : FROM - WHERE - GROUP BY - HAVING - SELECT - ORDER BY







>## SQL 예제



<PRE>
<CODE>

SELECT		dept_id,					#5. 최종적으로 보여줄 컬럼만 선택

&nbsp;		AVG(salary) "평균값"



FROM		emp				        	#1. emp 테이블에서 데이터 가져옴

WHERE		job_id != 'IT_PROG'	    	#2. IT_PROG 직무는 제외

GROUP BY	dept_id				    	#3. 부서별로 묶음

HAVING		AVG(salary) >= 5000	    	#4. 그룹 평균이 5000미만인 부서는 제외

ORDER BY	avg_salary DESC;			#6. 결과를 평균급여 높은 순으로 정렬

</CODE>
</PRE>

</BR>
</BR>
</BR>


#### 서브 쿼리도 똑같은 매커니즘 (단, SELECT, FROM, WHERE, HAVING절에서 사용가능)



</BR>
</BR>
</BR>



>## 서브쿼리란?

>하나의 SQL문 안에 **또 다른 SELECT문을 포함**하는 것
메인쿼리가 사용하는 값을 **서브쿼리가 제공**하거나 메인쿼리가 읽은 값을
**서브쿼리에서 검증**하는 구조

</BR>
</BR>
</BR>

## 사용 가능한 위치(구절)

- SELECT절 (스칼라) : 조회 컬럼 자리에 값 하나 (1행 1열 결과) 반환
- FROM절 (인라인뷰) : 서브쿼리 결과를 테이블처럼 사용
- WHERE/HAING절 : 비교조건에 서브쿼리 결과 활용
  
  **서브쿼리는 반드시 괄호()로 감싸야 함**

</BR>
</BR>
</BR>

>## 분류 기준별 정리

</BR>

### 사용 위치로 분류

| 종류       | 설명                                        |
| -------- | ----------------------------------------- |
| 스칼라 서브쿼리 | SELECT절에서 값 하나만 반환 (0행이면 NULL 취급)         |
| 인라인뷰     | FROM절에서 사용 — 서브쿼리 결과를 테이블처럼 JOIN/GROUP 가능 |

</BR>
</BR>

### 결과 행수로 분류
| 종류       | 설명                                         |
| -------- | ------------------------------------------ |
| 단일행 서브쿼리 | 결과가 1행 — `=`, `>`, `<`, `>=` 같은 비교연산 직접 가능 |
| 다중행 서브쿼리 | 결과가 여러 행 — `IN`, `ANY`, `ALL` 과 함께 사용      |

</BR>
</BR>

### 동작 방식으로 분류
| 종류       | 설명                                  |
| -------- | ----------------------------------- |
| 비상관 서브쿼리 | 서브쿼리 안에 메인쿼리컬럼 없음 → 먼저 서브쿼리 실행 후 제공 |
| 상관 서브쿼리  | 서브쿼리 안에 메인쿼리컬럼 존재 → 메인행 하나당 반복 확인   |

#### 이번 과정에서 상관 서브쿼리는 배우지 않는다.

